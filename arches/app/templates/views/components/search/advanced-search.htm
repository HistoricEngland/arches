{% load i18n %} {% load staticfiles %}
<!--ko let: { self: $data }-->
<div class="search-container advanced-search-container relative">
    <!-- Advanced Search Panel -->
    <div class="facets-container" style="">
        <div class="list-group search-facets">
            <div class="search-facet-item header">
                <p class="search-facet-item-heading h4">{% trans "Search Facets" %}</p>
                <div class="list-filter relative">
                    <input type="text" class="form-control" placeholder="{% trans "Find ..." %}" aria-label="{% trans "Find search facets" %}" data-bind="value: facetFilterText, valueUpdate: 'keyup'">
                    <!-- Clear Filter -->
                    <span class="clear-node-search" data-bind="click: function () { facetFilterText(''); }"><i
                            class="fa fa-times-circle"></i></span>
                </div>
            </div>
            <!-- ko foreach: searchableGraphs -->
            <!-- ko if: cards().length > 0  -->
            <!-- ko let: {uid: Math.random().toString()} -->
            <div tabindex="0" role="button" class="search-facet-item disabled" data-bind="onEnterkeyClick, onSpaceClick, click: function () { collapsed(!collapsed()) }, attr: {
                        'aria-expanded': (!collapsed()).toString(),
                        'aria-controls': uid,
                        'aria-label': name + ' graph facets',
                    }">
                <div class="search-facet-item-heading h4" >
                    <strong data-bind="text: name"></strong>
                    <span><i class="fa report-expander print-hide"
                            data-bind="css: {'fa-angle-down': !collapsed(), 'fa-angle-right': collapsed()}"></i></span>
                </div>
            </div>
            <div data-bind="visible: !collapsed()" role="list" data-bind="attr: {id: uid }">
                <!-- ko foreach: cards -->
                <a href="#" role="button" data-bind="click: addFacet, attr: {'aria-label': 'Add ' + name + ' facet to advanced search'}" class="search-facet-item">
                    <p data-bind="text: name"></p>
                </a>
                <!-- /ko -->
            </div>
            <!-- /ko -->
            <!-- /ko -->
            <!-- /ko -->
        </div>
    </div>
    <div class="facets-search-container" style="">
        <div data-bind="visible: filter.facets().length === 0">
            <div id="rr-splash" class="rr-splash">
                <!-- Image -->
                <div class="img-lg img-circle rr-splash-img-container">
                    <img class="rr-splash-img" src="{% static 'img/inspection.png' %}" alt="Advanced Search">
                </div>
                <!-- Splash Title -->
                <div class="rr-splash-title">{% trans "Advanced Search" %}</div>
                <!-- Splash Instructions -->
                <div class="rr-splash-description">{% trans "With Advanced Search you can build more sophisticated search queries." %}</div>
                <div class="rr-splash-description">{% trans "Select the search facets you wish to query from the list on the right. Then enter your" %}</div>
                <div class="rr-splash-description">{% trans "criteria to customize your search filters" %}</div>
            </div>
        </div>
        <!-- ko foreach: filter.facets -->
        <!-- ko if: $index  -->
        <div class="btn-group btn-group-sm facet-btn-group">
            <button class="btn btn-warning btn-active-dark facet-btn"
                data-bind="css: {'selected': value.op() === 'and'}, click: function () { value.op('and'); }">{% trans "And" %}</button>
            <button class="btn btn-warning btn-active-dark facet-btn"
                data-bind="css: {'selected': value.op() === 'or'}, click: function () { value.op('or'); }">{% trans "Or" %}</button>
        </div>
        <!-- /ko -->
        <div class="faceted-search-card-container">
            <div class="facet-name" data-bind="text: ko.unwrap(card.getGraph().name) + ' - ' + card.name"></div>
            <div class="row facet-search-criteria">
                <!-- ko foreach: card.nodes -->
                <div class="facet-body">
                    <div class="facet-label" data-bind="text: $data.label"></div>
                    <div data-bind="component: {
                        name: self.datatypelookup[datatype].configname,
                        params: {
                            search: true,
                            filterValue: $parent.value[nodeid],
                            node: $data,
                            datatype: self.datatypelookup[datatype]
                        }
                    }">
                    </div>
                </div>
                <!-- /ko -->
                <div class="facet-search-button pull-right">
                    <button class="btn btn-sm btn-primary"
                        data-bind="click: function (facet) { self.filter.facets.remove(facet); }">{% trans "Remove" %}</button>
                </div>
            </div>
        </div>
        <!-- /ko -->
    </div>
</div>
<!-- /ko -->